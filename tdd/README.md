# 테스트 주도 개발
- [서적 링크](http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&mallGb=KOR&barcode=9788966261024&orderClick=LEa&Kc=)

### 테스트 주도 개발(TDD)의 두 규칙
1) 오직 자동화된 테스트가 실패한 경우에만 새로운 코드를 작성
2) 중복을 제거

> 이 두 규칙으로 TDD 개발 순서가 정해진다.

### TDD 순서
1) 빨강: 실패하는 작은 테스트를 작성(컴파일 조차 되지 않을 수 있다)
2) 초록: 테스트가 통과하도록 만듬(어떤 방식으로든 테스트를 통과하게 만든다)
    - 중복이 아무리 많더라도 리팩터링을 하기 전 까지 프로덕션에 나가지 않으므로 문제가되지 않는다.
3) 리팩터링: 테스트가 통과되면 모든 중복을 제거

#### 테스트를 먼저 작성하면 얻을 수 있는 이점?
- 테스트를 작성하다가 처음 생각했던 구현보다 더 나은 구현 방법을 생각할 기회가 생김.
- 테스트를 먼저 작성하기 때문에 테스트를 통과시키기 위해 딱 필요한 코드만 작성할 수 있음
    - 모든 코드는 테스트를 위해 만들어 졌기 때문에 불필요한 코드들이 존재하지 않게 된다.
  
### 빠른 피드백의 중요성
- 자동화된 테스트는 코드를 완성하는 즉시 피드백을 준다. 
    - 코드를 완성하는 즉시 피드백을 받으면 빠르게 피드백을 반영할 수 있을 것이다.
- 반면 QA에만 의존하게 되면 피드백을 받는 속도가 매우 느려질 것이다.
    - 피드백을 늦게 받게되면 해당 피드백을 반영하기 위해 여러가지 요소들을 다시 생각해내야 한다.
    
### TODO 목록을 언제나 작성하자
- TODO 목록을 작성하면 신경쓸 일을 줄일 수 있고 까먹지 않게 된다.
    - 작업에 집중하다가 좋은 아이디어가 떠올라도 우선 TODO에 적어놓고 하던거 마저 하자.
    
### 단언 우선
- 테스트 작성 시 단언문을 먼저 작성해보자.
- 생각할 것이 많을 때 작업을 단순화시킬 수 있다.

### 회귀 테스트
- 시스템에 장애가 발생하였을 땐 해당 장애를 발생시킬 수 있는 테스트를 작성하자.
    - 단 테스트를 작성할 때 해당 장애를 해결하면 통과되도록 작성하자.
    
### 테스트의 목적
- 테스트를 작성하는 목적은 신뢰할 수 있는 코드를 만드는 것이다.
    - 만약 어떤 구현이 절대 변경되지 않고 신뢰할 수 있다면 테스트는 필요 없을 것이다.
- 결함 없는 완벽한 소프트웨어는 없지만 테스트 코드를 작성하면 자신감을 가지고 앞으로 전진할 수 있을 만큼 결함의 정도를 낮출 수 있다.


### 프로젝트 중반에 TDD 도입
- 테스트를 고려하지 않은 코드는 테스트를 작성하기 어렵게 되어있다.
    - 이를 위해 리팩터링을 하기엔, 이미 만들어진 테스트가 없어 에러 파악이 힘들기 떄문에 두려움이 생긴다.
    - 그렇다고 코드 전체에 대한 테스트를 한 번에 작성하고 리팩터링하기는 현실적으로 불가능하다.
- **변경의 범위를 제한하고, 가장 자주 변경되고 중요한 부분에 대한 테스트를 먼저 작성하자**

### TDD가 잘 작동하는 이유
- TDD는 분면항 결함 감소를 불어 일으킨다.
    - 결함이 감소되면 이차적인 심리학적 효과가 있고 코드에 대한 자신감이 생긴다.
    - 자신감이 생기면 리팩터링이 두려워지지 않아 더 자주 리팩터링을 하게되고 결국 코드는 더 깔끔해질 것이다.
- 설계 결정에 대한 피드백 고리를 단축시킨다.
    - 하루에서 수십, 수백 번 테스트를 돌리면서 피드백의 고리는 대폭적으로 줄어든다.
    - 즉시 피드백을 받는 것과 설계후 몇 주가 지나 피드백을 받는건 문제점을 파악하는데 분명한 차이가 있다.    

### 단일사고 방식
- 새로운 기능을 추가할 때 **좋은 설계와 구현**을 동시에 수행하는건 매우 어렵다.
    - 핵심적인 두 가지 작업을 분리하고 하나에 집중하도록 하면 복잡도를 줄이고 체계화하는데 많은 도움이 된다. 
- 먼저 가장 단순하게 테스를 통과시킬 수 있을만큼 기능을 구현한다.
- 구현이 비로소 완료되면 리팩터링을 통해 좋은 설계를 얻을 수 있도록 하자.

> `작동하는 클린코드를 얻는 것`은 매우 어렵다. 그러므로 우선 `작동하는`에 초점을 맞추어 구현하고, 그 후에 `클린 코드`를 얻을 수 있게 하자.

