# 1-5장 서비스 추상화

### 트랜잭션 동기화
- JDBC는 Connection 객체를 통해 트랜잭션의 시작과 종료를 정의한다.
- JPA의 경우 EntityManager에서 트랜잭션을 관리한다.
- JDBC와 JPA는 둘 다 데이터 엑세스 기술이지만 사용법은 다르다. 만약 이 Connection or EntityManager가 DAO 인터페이스에 존재한다면 다른 데이터 엑세스 기술로의 변경이 어려워 질 것이다.
    - 즉 인터페이스를 활용한 DI를 한 이유가 없어지게 된다.
    - 이 문제를 해결하기 위해 스프링이 제공하는 방법은 **독립적인 트랜잭션 동기화 방식이다.**(TransactionManger)
    - 트랜잭션 동기화 방식은 커넥션 풀을 이용하여 스레드 별 독립적인 커넥션 객체를 사용할 수 있게 해준다.
    - 만약 **트랜잭션이 동기화되어 있는 상태에서** JdbcTemplate을 사용하면 해당 Jdbc는 동기화된 커넥션을 사용게 된다.
    - 만약 트랜잭션 동기화가 되어 있지않다면 내부적으로 커넥션을 만들어 사용하기 때문에 DAO을 바로 사용해도 문제가 되진 않는다.
    
> 트랜잭션 동기화를 이용하면 인터페이스에 구현 기술과 관련된 Connection or EntityManager 같은 것들을 분리해낼 수 있다.
> - 내부적으로 동기화하여 사용하기 때문에 커넥션을 직접 사용하지 않아도 동기화된 커넥션을 사용하게 된다. 


### 트랜잭션 서비스 추상화
- 위에서 트랜잭션 동기화를 통해 인터페이스에 구현 기술과 관련된 객체를 제거했지만 여전히 Service 레이어에는 구현기술과 밀접하게 관련된 Connection 같은 객체를 사용해야 할 것이다.
- **스프링은 이러한 구현 기술 서비스와 애플리케이션 계층 사이에 서비스를 추상화 계층을 두어서 일관된 방식으로 기술을 사용할 수 있게 해준다.**
- 이 기술을 바탕으로 스프링은 트랜잭션을 추상화하여 여러 데이터 접근 기술의 트랜잭션 기술을 하나의 PlatformTransactionManager로 추상화하여 구현 기술이 변경되더라도 코드 변경 없이 일관된 방식으로 사용할 수 있게 해준다.
  
### 서비스 추상화와 단일 책임 원칙
- 구현 기술과 서비스에 대한 추상화 기법을 적용하면 특정 기술 환경에 종속되지 않은 포터블한 코드를 만들 수 있다.
- 결국 이 기법도 서비스 추상화 계층에 존재하는 추상화된 인터페이스에 의존하게하고 구현 기술이 변경될 땐 DI를 이용하여 기존 코드의 변경 없이 기술 변경을 가능하게 해주는 것이다.


### PSA란?
- 기술 하나에는 여러가지 방식으로 사용할 수 있는 구현 기술들이 존재하는데 이런 구현 기술들을 추상화하여 애플리케이션 계층과 분리하여 구현 기술이 변경되어도 애플리케이션 코드는 변경 없이 일관되게 사용할 수 있게 하는 추상화 기술
 
